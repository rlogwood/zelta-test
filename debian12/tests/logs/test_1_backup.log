+ set +e
+ zfs list
NAME                                     USED  AVAIL  REFER  MOUNTPOINT
apool                                   2.07M  96.4G    24K  /apool
apool/treetop                           1.70M  96.4G    89K  /apool/treetop
apool/treetop/add                         48K  96.4G    24K  /apool/treetop/add
apool/treetop/add/7                       24K  96.4G    24K  /apool/treetop/add/7
apool/treetop/minus                     1.18M  96.4G    89K  /apool/treetop/minus
apool/treetop/minus/two                  963K  96.4G    89K  /apool/treetop/minus/two
apool/treetop/minus/two/one              722K  96.4G    89K  /apool/treetop/minus/two/one
apool/treetop/minus/two/one/0            481K  96.4G    89K  /apool/treetop/minus/two/one/0
apool/treetop/minus/two/one/0/lift off   240K  96.4G    88K  /apool/treetop/minus/two/one/0/lift off
apool/treetop/vol1                       234K  96.4G    78K  -
bpool                                   2.07M  96.4G    24K  /bpool
bpool/treetop                           1.69M  96.4G    89K  /bpool/treetop
bpool/treetop/minus                     1.18M  96.4G    89K  /bpool/treetop/minus
bpool/treetop/minus/two                  963K  96.4G    89K  /bpool/treetop/minus/two
bpool/treetop/minus/two/one              722K  96.4G    89K  /bpool/treetop/minus/two/one
bpool/treetop/minus/two/one/0            481K  96.4G    89K  /bpool/treetop/minus/two/one/0
bpool/treetop/minus/two/one/0/lift off   240K  96.4G    88K  /bpool/treetop/minus/two/one/0/lift off
bpool/treetop/sub                         48K  96.4G    24K  /bpool/treetop/sub
bpool/treetop/sub/8                       24K  96.4G    24K  /bpool/treetop/sub/8
bpool/treetop/vol1                       234K  96.4G    78K  -
+ dataset_arg=bpool/Backups/apool
+ zelta backup apool bpool/Backups/apool
+ backup_output=source snapshot created: @2024-05-25_01.03.10
replicating 27 streams
1M sent, 34/34 streams received in 5.58 seconds
+ last_snapshot_name bpool/Backups/apool
+ dataset_name=bpool/Backups/apool
+ cmd=zfs list -t snapshot -o name,creation -s creation -r bpool/Backups/apool | grep "bpool/Backups/apool@" | tail -1 | awk -F'@' '{print $2}' | awk '{print $1}'
+ eval zfs list -t snapshot -o name,creation -s creation -r bpool/Backups/apool | grep "bpool/Backups/apool@" | tail -1 | awk -F'@' '{print $2}' | awk '{print $1}'
+ zfs list -t snapshot -o name,creation -s creation -r bpool/Backups/apool
+ grep bpool/Backups/apool@
+ tail -1
+ awk {print $1}
+ awk -F@ {print $2}
+ last_snapshot_name=2024-05-25_01.03.10
+ echo 2024-05-25_01.03.10
+ last_snapshot_name=2024-05-25_01.03.10
+ echo last_snapshot_name: 2024-05-25_01.03.10
last_snapshot_name: 2024-05-25_01.03.10
+ echo last_snapshot_name: 2024-05-25_01.03.10
last_snapshot_name: 2024-05-25_01.03.10
+ echo last_snapshot_name: 2024-05-25_01.03.10
last_snapshot_name: 2024-05-25_01.03.10
+ echo last_snapshot_name: 2024-05-25_01.03.10
last_snapshot_name: 2024-05-25_01.03.10
+ echo last_snapshot_name: 2024-05-25_01.03.10
last_snapshot_name: 2024-05-25_01.03.10
+ echo last_snapshot_name: 2024-05-25_01.03.10
last_snapshot_name: 2024-05-25_01.03.10
+ echo last_snapshot_name: 2024-05-25_01.03.10
last_snapshot_name: 2024-05-25_01.03.10
+ cat
+ placeholder_output=source snapshot created: @{last_snapshot_name}
replicating 29 streams
WARNING: could not send apool@{last_snapshot_name}:
cannot receive: failed to read from stream
WARNING: could not send apool/treetop/add@{last_snapshot_name}:
cannot receive: failed to read from stream
1M sent, 34/36 streams received in {time} seconds
+ set +x
** last_snapshot_name is 2024-05-25_01.03.10
backup command output without time is:
source snapshot created: @2024-05-25_01.03.10 replicating 27 streams 1M sent, 34/34 streams received in {time} seconds

expected output is:
source snapshot created: @2024-05-25_01.03.10 replicating 29 streams WARNING: could not send apool@2024-05-25_01.03.10: cannot receive: failed to read from stream WARNING: could not send apool/treetop/add@2024-05-25_01.03.10: cannot receive: failed to read from stream 1M sent, 34/36 streams received in {time} seconds

ERROR: Output doesn't match expected

